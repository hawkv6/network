# This lab is used to test the performance measurement configuration and the data collection via model-driven telemetry with XRd instances.
#
#                                        eth1┌────────────┐eth2
#                                     ┌──────┤  collector ├────────┐
#                                     │      └────────────┘        │
#                                     │                            │
#                                     │G0/0/0/3            G0/0/0/3│
#    ┌────────────┐     G0/0/0/2┌─────┴──────┐      G0/0/0/0┌──────┴─────┐G0/0/0/2    ┌────────────┐
#    │   host-a   ├─────────────┤    XR-1    ├──────────────┤     XR-2   ├────────────┤   host-b   │
#    └────────────┘eth1         └─────┬──────┘G0/0/0/0      └──────┬─────┘        eth1└────────────┘
#                                     │G0/0/0/1            G0/0/0/1│                        
#                                     │                            │
#                                     │                            │
#                                     │       ┌────────────┐       │
#                                     └───────┤    XR-3    ├───────┘
#                                     G0/0/0/0└────────────┘G0/0/0/1



name: test-performance-measurement-xrv9k

topology:
  nodes:

    XR-1:
      kind: cisco_xrv9k
      image: vrnetlab/vr-xrv9k:7.10.1 
      startup-config: config/XR-1.cfg

    XR-2:
      kind: cisco_xrv9k
      image: vrnetlab/vr-xrv9k:7.10.1 
      startup-config: config/XR-2.cfg

    XR-3:
      kind: cisco_xrv9k
      image: vrnetlab/vr-xrv9k:7.10.1 
      startup-config: config/XR-3.cfg

    collector:
      kind: linux
      image: ghcr.io/insrapperswil/network-ninja:1.0
      exec:
        - ip -6 address add 2001:db8:1f::f/64 dev eth1
        - ip -6 address add 2001:db8:2f::f/64 dev eth2

    host-a:
      kind: linux
      image: ghcr.io/insrapperswil/network-ninja:1.0
      exec:
        - ip -6 address add 2001:db8:1a::a/64 dev eth1

    host-b:
      kind: linux
      image: ghcr.io/insrapperswil/network-ninja:1.0
      exec:
        - ip -6 address add 2001:db8:2b::b/64 dev eth1


  links:
    - endpoints: ["XR-1:eth1", "XR-2:eth1"]
    - endpoints: ["XR-1:eth2", "XR-3:eth1"]
    - endpoints: ["XR-1:eth3", "host-a:eth1"]
    - endpoints: ["XR-1:eth4", "collector:eth1"]
    - endpoints: ["XR-2:eth2", "XR-3:eth2"]
    - endpoints: ["XR-2:eth3", "host-b:eth1"]
    - endpoints: ["XR-2:eth4", "collector:eth2"]
